from yacs.config import CfgNode as CN

_C = CN()
_C.SCENE = "indoor1"
_C.SUBJECT = "001"
_C.GESTURE = 0
_C.ROOT = ""
_C.OUTPUT = "initparams.json"
_C.USAGE = "fit_shape"
_C.AUX_VIEWS = ["rgb_0", "rgb_1", "rgb_2", "rgb_3"]
_C.MAIN_VIEWS = ["rgb_4", "rgb_5", "rgb_6"]
_C.INIT = "images"
# Extract shape paramters
_C.FIT_SHAPE = CN()
_C.FIT_SHAPE.DEVICE = "cuda:0"
_C.FIT_SHAPE.STEP_SIZE = 0.02
_C.FIT_SHAPE.NUM_ITERS = 1200
_C.FIT_SHAPE.MIN_ITERS = 200
_C.FIT_SHAPE.THRESHOLD = 0.1
_C.FIT_SHAPE_PRIOR_WEIGHT = 5.
_C.FIT_SHAPE.POSE_PRIOR_WEIGHT = 4.78
_C.FIT_SHAPE.POSE_TEMP_WEIGHT = 100.
_C.FIT_SHAPE.TRAN_TEMP_WEIGHT = 300.
_C.FIT_SHAPE.ROT_TEMP_WEIGHT = 100.
_C.FIT_SHAPE.SHAPE_TEMP_WEIGHT = 1000.
_C.FIT_SHAPE.PCA_NCOMPS = 6
_C.FIT_SHAPE.USE_VPOSER = True
_C.FIT_SHAPE.INTERPENETRATION = False
_C.FIT_SHAPE.COLL_LOSS_WEIGHT = 0.
_C.FIT_SHAPE.JOINTS2D_WEIGHT = 1.
_C.FIT_SHAPE.POINTCLOUD_WEIGHT = 0.
_C.FIT_SHAPE.SILHOUETTE_WEIGHT = 0.
_C.FIT_SHAPE.USE_JOINTS_CONF = True
_C.FIT_SHAPE.WEAK_SIGMA = 1.0
_C.FIT_SHAPE.OPTIMIZER = "adam"
_C.FIT_SHAPE.STAGE_FIT_CAMERA = True
_C.FIT_SHAPE.VERBOSE = True  # True
_C.FIT_SHAPE.DEPTH_WEIGHT = 100
_C.FIT_SHAPE.FINGER_WEIGHT = 4000
_C.FIT_SHAPE.VISUALIZE = False
_C.FIT_SHAPE.SAVE_ALL = False
_C.FIT_SHAPE.HANDSIDE = "right"
_C.FIT_SHAPE.VERTICES_PATH = "meshes/"
_C.FIT_SHAPE.OUTPUT_DIR = "outputs/fit_shape/"
# Estimate 2D keypoints
_C.GET_JOINTS2D = CN()
_C.GET_JOINTS2D.METHOD = "openpose"
_C.GET_JOINTS2D.ITERATIVE = 0
_C.GET_JOINTS2D.SAVE = False
_C.GET_JOINTS2D.VISUALIZE = False
_C.GET_JOINTS2D.SAVE_FILE = ""
_C.GET_JOINTS2D.OUTPUT_DIR = ""
_C.GET_JOINTS2D.REFINE = "donot"
_C.GET_JOINTS2D.HANDS = ["right"]
_C.GET_JOINTS2D.OPENPOSE = CN()
_C.GET_JOINTS2D.OPENPOSE.MODEL_POSE = "BODY_135"
_C.GET_JOINTS2D.OPENPOSE.NET_RESOLUTION = "-1x480"
_C.GET_JOINTS2D.HRNET = CN()
_C.GET_JOINTS2D.HRNET.CONFIG = "cfg_files/w32_224x224_adam_lr1e-3.yaml"
_C.GET_JOINTS2D.HRNET.MODEL_FILE = "models/best_6.173.pth"
_C.GET_JOINTS2D.HRNET.HAND_DETECTOR = "openpose"
_C.GET_JOINTS2D.HRNET.POSE_INPUTSIZE = 224
_C.GET_JOINTS2D.HRNET.EXPAND_RATIO = 1.2
# Extract all hand parameters
_C.FIT_ALL = CN()
_C.FIT_ALL.CORRECT_SHAPE = False
_C.FIT_ALL.TRANS_FROM_BODY = False
_C.FIT_ALL.FIX_TRANS = False
_C.FIT_ALL.CALIBRATION_FILE = "Calibration.json"
# Solver
_C.SOLVER = CN()
_C.SOLVER.STEP_SIZE = 0.01
_C.SOLVER.NUM_ITERS = 1200
_C.SOLVER.THRESHOLD = 1e-4
_C.SOLVER.DEVICE = "cuda"
_C.SOLVER.HANDMODEL_PATH = "models/smplh/"
_C.SOLVER.VERBOSE = True
_C.SOLVER.W_POSEPRIOR = 10.0
_C.SOLVER.W_REPROJECTION = 0.1
_C.SOLVER.W_TEMPORALPRIOR = 1.0

